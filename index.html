<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ ÙÙŠ Ø°ÙŠ Ù‚Ø§Ø±</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<style>
  body { font-family:'Tajawal',sans-serif; margin:0; padding:0; background:#eef2f7; color:#333; }

  header {
    background:linear-gradient(135deg, #0066cc, #004080);
    color:#fff;
    text-align:center;
    padding:25px 15px;
    box-shadow:0 4px 12px rgba(0,0,0,0.25);
  }
  header img {
    width:150px; height:150px;
    border-radius:50%;
    border:3px solid #fff;
    margin-bottom:12px;
    object-fit:cover;
  }
  header h1 { margin:5px 0 0; font-size:1.7rem; }

  #city-container {
    max-width:400px;
    margin:25px auto;
    padding:20px;
    background:#fff;
    border-radius:15px;
    box-shadow:0 3px 10px rgba(0,0,0,0.1);
    text-align:center;
  }
  #city-input {
    padding:12px 15px;
    border-radius:12px;
    border:1px solid #ccc;
    font-size:1.05rem;
    width:100%;
    margin-bottom:12px;
  }
  #city-submit {
    padding:12px 15px;
    border:none;
    background:#0066cc;
    color:#fff;
    border-radius:12px;
    cursor:pointer;
    font-weight:bold;
    width:100%;
    font-size:1rem;
  }
  #city-submit:hover { background:#004080; }

  /* ØªØ­Ø³ÙŠÙ† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø­Ø« */
  #search-container {
    max-width:100%;
    margin:0;
    padding:12px 15px;
    display:flex;
    justify-content:center;
    background:#fff;
    position:sticky;
    top:0;
    z-index:100;
    box-shadow:0 2px 8px rgba(0,0,0,0.1);
  }
  #search-input {
    flex:1;
    padding:12px 16px;
    border-radius:20px;
    border:1px solid #ccc;
    font-size:1rem;
    max-width:500px;
    background:#f9f9f9;
    transition:all 0.3s;
  }
  #search-input:focus {
    outline:none;
    border-color:#0066cc;
    background:#fff;
    box-shadow:0 0 6px rgba(0,102,204,0.3);
  }

  .section-title {
    text-align:center;
    margin:25px 0 15px 0;
    font-size:1.2rem;
    font-weight:bold;
    color:#004080;
  }

  #promoted, #list {
    max-width:1100px;
    margin:0 auto 40px auto;
    padding:0 15px;
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
    gap:15px;
  }

  .doctor {
    background:#fff;
    padding:16px;
    border-radius:15px;
    box-shadow:0 3px 10px rgba(0,0,0,0.12);
    transition:0.3s;
    display:flex;
    flex-direction:column;
    align-items:center;
    text-align:center;
  }
  .doctor:hover { transform:translateY(-5px); box-shadow:0 8px 18px rgba(0,0,0,0.2); }
  .doctor img {
    width:90px; height:90px;
    border-radius:50%;
    object-fit:cover;
    margin-bottom:10px;
  }
  .doctor h3 { margin:0 0 5px; font-size:1.15rem; color:#0066cc; }
  .doctor .specialty { color:#444; font-size:0.9rem; margin-bottom:5px; font-weight:bold; }
  .doctor p { margin:3px 0; font-size:0.9rem; }
  .doctor a { color:#009933; text-decoration:none; font-weight:bold; }
  .stars { font-size:1.1rem; margin-top:6px; color:#FFD700; }

  @media (max-width:600px) {
    header img { width:120px; height:120px; }
    header h1 { font-size:1.4rem; }
    #city-container { margin:15px; padding:15px; }
    #search-input { font-size:0.95rem; }
  }
</style>
</head>
<body>

<header>
  <img src="https://images.unsplash.com/photo-1622253692010-333f2da6031d?crop=entropy&cs=tinysrgb&fit=crop&h=400&w=400" alt="Ø·Ø¨ÙŠØ¨ Ø§Ø­ØªØ±Ø§ÙÙŠ">
  <h1>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ ÙÙŠ Ø°ÙŠ Ù‚Ø§Ø±</h1>
</header>

<div id="city-container">
  <input type="text" id="city-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ù…Ø¯ÙŠÙ†ØªÙƒ ÙÙŠ Ø°ÙŠ Ù‚Ø§Ø±">
  <button id="city-submit">Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</button>
</div>

<div id="search-container" style="display:none;">
  <input type="text" id="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø¨ÙŠØ¨ Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø§Ø®ØªØµØ§Øµ...">
</div>

<h2 class="section-title">Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ Ø§Ù„Ù…Ø±ÙˆØ¬ÙˆÙ†</h2>
<div id="promoted">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

<h2 class="section-title">Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ ÙÙŠ Ù…Ø¯ÙŠÙ†ØªÙƒ</h2>
<div id="list">Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ù…Ø¯ÙŠÙ†ØªÙƒ Ø£Ø¹Ù„Ø§Ù‡ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</div>

<script>
let allDoctors = [];
let userCity = "";

// ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡
async function loadDoctors() {
  const url = "https://docs.google.com/spreadsheets/d/1vkxj1YSt1kHbouOlxoSVHMPMVh0eKElFH0vFDQ-eaRQ/gviz/tq?tqx=out:json";
  const res = await fetch(url);
  const text = await res.text();
  const json = JSON.parse(text.substr(47).slice(0,-2));

  allDoctors = json.table.rows.map(row => ({
    name: row.c[0] ? row.c[0].v : "",
    place: row.c[1] ? row.c[1].v : "",
    whatsapp: row.c[2] ? row.c[2].v : "",
    starsCount: row.c[3] ? parseInt(row.c[3].v) : 0,
    promo: row.c[4] ? row.c[4].v : "",
    specialty: row.c[5] ? row.c[5].v : "",
    img: row.c[6] ? row.c[6].v : "" // ØµÙˆØ±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  }));

  // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±ÙˆØ¬ÙŠÙ† ÙÙˆØ±Ø§Ù‹
  const promoted = allDoctors.filter(d => d.promo && d.promo.trim().toLowerCase() === "Ù…Ø±ÙˆØ¬");
  displayDoctors(promoted, "promoted");
}

// Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ ÙÙŠ Ù…ÙƒØ§Ù† Ù…Ø­Ø¯Ø¯
function displayDoctors(doctors, containerId) {
  const listDiv = document.getElementById(containerId);
  listDiv.innerHTML = "";
  if(doctors.length === 0) {
    if (containerId === "list") {
      listDiv.innerHTML = `<p style="text-align:center;color:#c00;font-weight:bold;">âŒ Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø·Ø¨Ø§Ø¡ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù…Ø¯ÙŠÙ†Ø© Ø£Ø®Ø±Ù‰.</p>`;
      document.getElementById("city-container").style.display = "block";
      document.getElementById("search-container").style.display = "none";
      document.getElementById("city-input").value = "";
    }
    return;
  }

  doctors.forEach(d => {
    let stars = "";
    for (let i=1; i<=5; i++) stars += i<=d.starsCount ? "â˜…" : "â˜†";

    const card = document.createElement("div");
    card.className = "doctor";
    card.innerHTML = `
      <img src="${d.img || 'https://cdn-icons-png.flaticon.com/512/387/387561.png'}" alt="ØµÙˆØ±Ø© Ø·Ø¨ÙŠØ¨">
      <h3>${d.name}</h3>
      <div class="specialty">ğŸ©º ${d.specialty}</div>
      <p>ğŸ“ ${d.place}</p>
      <p>ğŸ“± <a href="https://wa.me/${d.whatsapp}" target="_blank">${d.whatsapp}</a></p>
      <p class="stars">${stars}</p>
    `;
    listDiv.appendChild(card);
  });
}

// Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©
document.getElementById("search-input").addEventListener("input", function(){
  const query = this.value.toLowerCase();
  const filtered = allDoctors.filter(d =>
    d.place.toLowerCase() === userCity.toLowerCase() &&
    (d.name.toLowerCase().includes(query) || d.specialty.toLowerCase().includes(query))
  );
  displayDoctors(filtered, "list");
});

// Ø¨Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©
document.getElementById("city-submit").addEventListener("click", function(){
  const input = document.getElementById("city-input").value.trim();
  if(input === "") return alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ù…Ø¯ÙŠÙ†ØªÙƒ");
  userCity = input;
  const cityDoctors = allDoctors.filter(d => d.place.toLowerCase() === userCity.toLowerCase());
  displayDoctors(cityDoctors, "list");

  if(cityDoctors.length > 0) {
    document.getElementById("city-container").style.display = "none";
    document.getElementById("search-container").style.display = "flex";
  }
});

loadDoctors();
</script>
</body>
</html>