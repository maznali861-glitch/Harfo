<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>شراء مشاهدات تيك توك</title>

<!-- 🌐 صورة المعاينة عند المشاركة -->
<meta property="og:title" content="موقع HARFO | شراء مشاهدات تيك توك">
<meta property="og:description" content="احصل على مشاهدات حقيقية لبثك المباشر في تيك توك.">
<meta property="og:image" content="https://i.ibb.co/jvN8hWv/harfo-preview.jpg">
<meta property="og:type" content="website">
<meta property="og:url" content="https://your-domain.com/">

<style>
:root{
--bg:#0b0d10; --card:#0f1114; --muted:#9aa1a8; --accent:#22c1c3; --glass: rgba(255,255,255,0.03);
}
*{box-sizing:border-box;font-family:Inter, "Segoe UI", Tahoma, sans-serif}
body{margin:0;background:linear-gradient(180deg,#050607 0%, #0b0d10 100%);color:#e6eef2;direction:rtl}
.wrap{max-width:600px;margin:40px auto;padding:20px}
header{text-align:center;margin-bottom:25px}
header h1{font-size:24px;margin-bottom:8px}
.telegram-link{display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:10px;cursor:pointer;text-decoration:none;color:var(--accent)}
.telegram-link img{width:30px;height:30px}
.card{background:var(--card);padding:20px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.03);margin-bottom:20px}
.small{font-size:13px;color:var(--muted)}
.btn{display:inline-block;padding:10px 14px;border-radius:10px;background:linear-gradient(90deg,var(--accent),#14a8ab);color:#041014;font-weight:700;text-decoration:none;cursor:pointer;border:none}
.form{margin-top:18px;display:grid;grid-template-columns:1fr;gap:12px}
label{font-size:13px;color:var(--muted)}
input, select{width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit;font-size:14px}
.success{background:linear-gradient(90deg,#054b2c,#0b7a46);padding:12px;border-radius:8px;color:#e8fff0;margin-top:10px}
.error{background:linear-gradient(90deg,#3b0b0b,#6b0f0f);padding:12px;border-radius:8px;color:#ffecec;margin-top:10px}
.note-warning{background:#1a0e0e;color:#ffbaba;padding:10px;border-radius:8px;margin-top:10px;font-size:13px;text-align:center}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>شراء مشاهدات لايف تيك توك</h1>
    <a class="telegram-link" href="https://t.me/Mrdinary" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" alt="Telegram">
      <span>تواصل مع الوكيل الرسمي</span>
    </a>
  </header>

  <section class="card">
    <strong>اختر الباقة</strong>
    <div class="small">المشاهدين ثابتين حتى نهاية البث</div>
    <select id="packageSelect" onchange="toggleAgentKey()">
      <option value="">-- اختر باقة --</option>
      <option value="free">🎁 باقة مجانية — 5 مشاهدين (Free)</option>
      <option value="1">LVL1 — 10-20 مشاهدة ($3)</option>
      <option value="2">LVL2 — 25-45 مشاهدة ($10)</option>
      <option value="3">LVL3 — 50-70 مشاهدة ($15)</option>
      <option value="4">LVL4 — 70-100 مشاهدة ($20)</option>
    </select>
  </section>

  <section class="card">
    <strong>بيانات تيك توك</strong>
    <div class="small">املأ المعلومات التالية بدقة</div>
    <form id="orderForm" class="form" onsubmit="return submitOrder(event)">
      <label>رابط البث (URL)</label>
      <input id="liveLink" placeholder="https://www.tiktok.com/..." required>
      
      <label>اسم المستخدم على تيك توك</label>
      <input id="tiktokUser" placeholder="مثال: username123" required>

      <div id="agentKeyField">
        <label>توقيع الوكيل (المفتاح)</label>
        <input id="agentKey" placeholder="ادخل توقيع الوكيل">
      </div>

      <button type="submit" class="btn">إرسال الطلب</button>
      <div id="messageBox" aria-live="polite"></div>
    </form>
  </section>

  <section class="note-warning">
    ⚠️ إذا لم تقم بالشراء من البائع، لن يتم احتساب أي مشاهدين
  </section>
</div>

<script>
const TELEGRAM_BOT_TOKEN = '357723373:AAHz5-Mj8GWT1NMKTmicYHq8aMDq6BJgMeM';
const TELEGRAM_CHAT_ID = '250273112';
const AGENT_KEY = 'rt555'; // المفتاح الصحيح
const FREE_LIMIT_HOURS = 1; // المدة ساعة واحدة

function toggleAgentKey(){
  const selected = document.getElementById('packageSelect').value;
  const field = document.getElementById('agentKeyField');
  if(selected === 'free'){
    field.style.display = 'none';
  }else{
    field.style.display = 'block';
  }
}

async function sendToTelegram(text){
  const url = `https://api.telegram.org/bot${encodeURIComponent(TELEGRAM_BOT_TOKEN)}/sendMessage`;
  const body = { chat_id: TELEGRAM_CHAT_ID, text: text, parse_mode: 'HTML' };
  const res = await fetch(url,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify(body)
  });
  const data = await res.json();
  if(!data.ok) throw new Error('خطأ في الإرسال: ' + (data.description || JSON.stringify(data)));
  return data;
}

function canUseFreePackage(){
  const lastUse = localStorage.getItem('lastFreeUse');
  if(!lastUse) return true;
  const elapsed = (Date.now() - parseInt(lastUse)) / (1000 * 60 * 60); // ساعات
  return elapsed >= FREE_LIMIT_HOURS;
}

function remainingMinutes(){
  const lastUse = localStorage.getItem('lastFreeUse');
  if(!lastUse) return 0;
  const elapsed = (Date.now() - parseInt(lastUse)) / (1000 * 60);
  return Math.max(0, 60 - elapsed).toFixed(0);
}

async function submitOrder(e){
  e.preventDefault();
  const level = document.getElementById('packageSelect').value;
  const live = document.getElementById('liveLink').value.trim();
  const user = document.getElementById('tiktokUser').value.trim();
  const key = document.getElementById('agentKey').value.trim();
  const box = document.getElementById('messageBox');
  box.innerHTML = '';

  if(!level){ box.innerHTML='<div class="error">اختر الباقة.</div>'; return false; }
  if(!/^https?:\/\//i.test(live)){ box.innerHTML='<div class="error">رابط اللايف يجب أن يبدأ بـ http:// أو https://</div>'; return false; }
  if(user.length<2){ box.innerHTML='<div class="error">اكتب اسم المستخدم على تيك توك.</div>'; return false; }

  const levels = { 
    'free':'🎁 باقة مجانية — 5 مشاهدين', 
    '1':'LVL1 — 10-20', 
    '2':'LVL2 — 25-45', 
    '3':'LVL3 — 50-70', 
    '4':'LVL4 — 70-100' 
  };
  const time = new Date().toLocaleString('ar-EG');

  // تحقق من الباقة المجانية
  if(level === 'free'){
    if(!canUseFreePackage()){
      const mins = remainingMinutes();
      box.innerHTML = `<div class="error">⏳ لا يمكنك طلب الباقة المجانية الآن.<br>يرجى المحاولة بعد ${mins} دقيقة.</div>`;
      return false;
    }
    localStorage.setItem('lastFreeUse', Date.now().toString());
  }

  // التحقق من المفتاح فقط لغير المجاني
  if(level !== 'free' && key !== AGENT_KEY){
    box.innerHTML = '<div class="error">تواصل مع الوكيل لشراء المشاهدين</div>';
    return false;
  }

  const message =
`📥 <b>طلب مشاهدات (Live Order)</b>
🕒 ${time}
🏷 الباقة: ${levels[level]}
🔗 رابط اللايف: ${live}
👤 اسم تيك توك: ${user}
${level === 'free' ? '💎 نوع الطلب: مجاني (مرة كل ساعة)' : '✅ حالة: تم استلام الطلب من الواجهة'}`;

  box.innerHTML='<div class="small">جاري إرسال الطلب إلى البوت...</div>';
  try{
    await sendToTelegram(message);
    box.innerHTML='<div class="success">تم استلام طلبك بنجاح ✅ — تم إرسال التفاصيل إلى البوت.</div>';
    document.getElementById('orderForm').reset();
    toggleAgentKey();
  }catch(err){
    box.innerHTML=`<div class="error">فشل الإرسال: ${err.message || err}</div>`;
  }
}
</script>
</body>
</html>